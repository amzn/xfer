language: python
os: linux
python:
  - '3.4'
  - '3.5'
before_install:
  - ./.travis/install.sh
install:
  - pip install -r requirements.txt
  - pip install -r test_requirements.txt
  - pip install -r docs/requirements.txt
script:
  - flake8
  - nosetests --with-coverage tests/unit/
  - nosetests --with-coverage tests/integration/
after_success:
  - codecov
jobs:
  include:
    - stage: release
      python: '3.6' # Official supported Python dist.
      deploy:
        provider: pypi
        server: https://test.pypi.org/legacy/ # Remove for deployment to official PyPi repo
        user: jmas
        password:
          secure: encrypted_pypi_password_REPLACEME
        on:
          branch: master